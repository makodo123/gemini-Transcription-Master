#!/usr/bin/env bash
set -e

# Block common Google API key pattern
if git diff --cached --name-only | xargs -r grep -nE 'AIzaSy[0-9A-Za-z_-]{20,}' >/tmp/key_scan_out 2>/dev/null; then
  echo "âŒ Commit blocked: possible API key detected"
  cat /tmp/key_scan_out
  exit 1
fi
